<local:ActivatablePage x:Class="JitHubV3.Presentation.IssueConversationPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:JitHubV3.Presentation"
      xmlns:utu="using:Uno.Toolkit.UI"
  xmlns:md="using:JitHub.Markdown.Uno"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
  <Grid utu:SafeArea.Insets="VisibleBounds">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <utu:NavigationBar Content="{Binding Title}" />

    <Grid Grid.Row="1"
          Padding="16"
          RowSpacing="12"
          MaxWidth="900"
          HorizontalAlignment="Center">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <Button Content="Back"
              Command="{Binding GoBack}"
              HorizontalAlignment="Left" />

      <TextBlock Grid.Row="1"
                 Text="{Binding Status}"
                 TextWrapping="Wrap" />

      <StackPanel Grid.Row="2" Spacing="4">
        <TextBlock TextWrapping="Wrap">
          <Run Text="#" />
          <Run Text="{Binding Issue.Number}" />
          <Run Text=" 路 " />
          <Run Text="{Binding Issue.Title}" />
        </TextBlock>

        <TextBlock TextWrapping="Wrap">
          <Run Text="By " />
          <Run Text="{Binding Issue.AuthorLogin}" />
          <Run Text=" 路 " />
          <Run Text="{Binding Issue.State}" />
          <Run Text=" 路 " />
          <Run Text="{Binding Issue.CommentCount}" />
          <Run Text=" comments" />
        </TextBlock>
      </StackPanel>

      <Border Grid.Row="3"
              Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
              Padding="12"
              CornerRadius="8">
        <md:MarkdownView Markdown="{Binding Issue.Body, TargetNullValue=''}"
                         HorizontalAlignment="Stretch" />
      </Border>

      <ListView Grid.Row="4"
                ItemsSource="{Binding Comments}"
                HorizontalContentAlignment="Stretch"
                SelectionMode="None">
        <ListView.ItemTemplate>
          <DataTemplate>
            <StackPanel Spacing="6" Padding="0,8" HorizontalAlignment="Stretch">
              <TextBlock TextWrapping="Wrap">
                <Run Text="{Binding AuthorLogin}" />
                <Run Text=" 路 " />
                <Run Text="{Binding CreatedAt}" />
              </TextBlock>
              <md:MarkdownView Markdown="{Binding Body, TargetNullValue=''}"
                               HorizontalAlignment="Stretch" />
            </StackPanel>
          </DataTemplate>
        </ListView.ItemTemplate>
      </ListView>
    </Grid>
  </Grid>
</local:ActivatablePage>
